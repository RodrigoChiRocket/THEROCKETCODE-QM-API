<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qualitas.portal.fraudes.account.dao.ReglasAlertadasDao">

    <!-- Inserci贸n de nueva regla alertada -->
    <insert id="crearReglaAlertada" useGeneratedKeys="true" keyProperty="iRAlertaID">
        INSERT INTO T_REGLAS_ALERTADAS (V_DESCRIPCION, I_SCORE, I_SINIESTRO_ID)
        VALUES (#{vDescripcion}, #{iScore}, #{iSiniestroID})
    </insert>

    <!-- Selecci贸n de una regla alertada por ID -->
    <select id="obtenerReglaAlertada" resultMap="ReglaAlertadaResultado">
        SELECT * FROM T_REGLAS_ALERTADAS WHERE I_R_ALERTA_ID = #{id}
    </select>

    <!-- Mapeo del resultado -->
    <resultMap id="ReglaAlertadaResultado" type="com.qualitas.portal.fraudes.account.model.ReglaAlertada">
        <id property="iRAlertaID" column="I_R_ALERTA_ID"/>
        <result property="vDescripcion" column="V_DESCRIPCION"/>
        <result property="iScore" column="I_SCORE"/>
        <result property="iSiniestroID" column="I_SINIESTRO_ID"/>
    </resultMap>

    <!-- Actualizaci贸n de una regla alertada -->
    <update id="actualizarReglaAlertada" parameterType="com.qualitas.portal.fraudes.account.model.ReglaAlertada">
        UPDATE T_REGLAS_ALERTADAS
        SET V_DESCRIPCION = #{vDescripcion}, I_SCORE = #{iScore}, I_SINIESTRO_ID = #{iSiniestroID}
        WHERE I_R_ALERTA_ID = #{iRAlertaID}
    </update>

    <!-- Listado de todas las reglas alertadas -->
    <select id="listarReglasAlertadas" resultMap="ReglaAlertadaResultado">
        SELECT * FROM T_REGLAS_ALERTADAS
    </select>

    <select id="obtenerReglasAlertadasPorSiniestro" resultMap="ReglaAlertadaResultado">
        SELECT * FROM T_REGLAS_ALERTADAS WHERE I_SINIESTRO_ID = #{id}
    </select>

    <!-- Eliminaci贸n de una regla alertada -->
    <delete id="eliminarReglaAlertada">
        DELETE FROM T_REGLAS_ALERTADAS WHERE I_R_ALERTA_ID = #{id}
    </delete>

</mapper>
